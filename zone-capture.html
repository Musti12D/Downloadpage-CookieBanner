<!DOCTYPE html>
<html>
<head>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  html, body {
    width: 100%;
    height: 100%;
    background: transparent;
    cursor: crosshair;
    user-select: none;
    -webkit-app-region: no-drag;
    overflow: hidden;
  }

  #sel {
    position: fixed;
    border: 2px solid #e8ff47;
    background: rgba(232,255,71,0.08);
    display: none;
    pointer-events: none;
    z-index: 10;
  }

  #tip {
    position: fixed;
    top: 20px; left: 50%;
    transform: translateX(-50%);
    background: #e8ff47;
    color: #000;
    padding: 6px 16px;
    border-radius: 20px;
    font-family: monospace;
    font-size: 12px;
    font-weight: 600;
    z-index: 20;
    pointer-events: none;
  }

  #coords {
    position: fixed;
    bottom: 20px; left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.7);
    color: #e8ff47;
    padding: 4px 14px;
    border-radius: 20px;
    font-family: monospace;
    font-size: 12px;
    z-index: 20;
    pointer-events: none;
  }
</style>
</head>
<body>
<div id="tip">Fläche markieren — ziehen &amp; loslassen · ESC = Abbrechen</div>
<div id="coords">0 × 0</div>
<div id="sel"></div>

<script>
  const { ipcRenderer } = require('electron');
  const sel = document.getElementById('sel');
  const coords = document.getElementById('coords');
  let start = null;

  window.addEventListener('mousedown', e => {
    start = { x: e.clientX, y: e.clientY, screenX: e.screenX, screenY: e.screenY };
    sel.style.display = 'block';
    sel.style.left = e.clientX + 'px';
    sel.style.top = e.clientY + 'px';
    sel.style.width = '0';
    sel.style.height = '0';
  });

  window.addEventListener('mousemove', e => {
    if (!start) return;
    const x = Math.min(e.clientX, start.x);
    const y = Math.min(e.clientY, start.y);
    const w = Math.abs(e.clientX - start.x);
    const h = Math.abs(e.clientY - start.y);
    sel.style.left   = x + 'px';
    sel.style.top    = y + 'px';
    sel.style.width  = w + 'px';
    sel.style.height = h + 'px';
    coords.textContent = `${Math.abs(e.screenX - start.screenX)} × ${Math.abs(e.screenY - start.screenY)} px`;
  });

  window.addEventListener('mouseup', e => {
    if (!start) return;
    ipcRenderer.send('zone-captured', {
      x1: Math.min(e.screenX, start.screenX),
      y1: Math.min(e.screenY, start.screenY),
      x2: Math.max(e.screenX, start.screenX),
      y2: Math.max(e.screenY, start.screenY)
    });
    start = null;
  });

  window.addEventListener('keydown', e => {
    if (e.key === 'Escape') ipcRenderer.send('zone-captured', null);
  });
</script>
</body>
</html>